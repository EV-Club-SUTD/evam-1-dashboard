import React, { useEffect } from 'react';
import { View } from 'react-native';
import {
  useSharedValue,
  withRepeat,
  withTiming,
} from 'react-native-reanimated';
import Svg, { Path } from 'react-native-svg';

import { FINAL_TOP_INDICATOR_HEIGHT } from '../utils/config';
import AnimatedIndicator from './AnimatedIndicator';

const transforms = [
  'matrix(1 0 0 -1 45.5 45.5)',
  'matrix(1 0 0 -1 156.5 45.5)',
  'matrix(1 0 0 -1 267.5 45.5)',
  'matrix(1 0 0 -1 378.5 45.5)',
  'matrix(1 0 0 -1 489.5 45.5)',
];

const TopIndicator = (): JSX.Element => {
  const progress = useSharedValue(0);
  useEffect(() => {
    progress.value = withRepeat(withTiming(1, { duration: 2000 }), -1, true);
  }, [progress]);

  return (
    <View
      style={{
        alignItems: 'center',
        backgroundColor: 'black',
      }}>
      <Svg
        width='60%'
        height={FINAL_TOP_INDICATOR_HEIGHT}
        viewBox='0 0 535 121'
        fill='none'>
        {transforms.map((transform, key) => (
          <AnimatedIndicator
            transform={transform}
            progress={progress}
            // eslint-disable-next-line react/no-array-index-key
            key={key}
          />
        ))}
        <Path
          d='M135.52 115H148.48V112.93H137.77V105.43H147.25V103.39H137.77V96.07H148.33V94H135.52V115ZM158.392 115.3C162.142 115.3 164.902 112.93 164.902 109.57V109.51C164.902 106.72 163.342 105.01 159.082 103.42C155.122 101.98 154.192 100.93 154.192 99.1V99.04C154.192 97.24 155.752 95.77 158.152 95.77C159.982 95.77 161.632 96.46 163.192 97.81L164.542 96.07C162.682 94.45 160.672 93.7 158.242 93.7C154.552 93.7 151.912 96.1 151.912 99.25V99.31C151.912 102.28 153.622 103.84 157.972 105.46C161.782 106.81 162.622 107.92 162.622 109.66V109.69C162.622 111.7 160.942 113.23 158.422 113.23C156.052 113.23 154.252 112.24 152.512 110.62L151.102 112.33C153.292 114.37 155.692 115.3 158.392 115.3ZM177.139 115.3C180.019 115.3 182.029 114.16 183.799 112.42L182.449 110.86C180.949 112.3 179.419 113.2 177.259 113.2C173.389 113.2 170.419 109.69 170.419 104.53V104.41C170.419 99.34 173.389 95.8 177.259 95.8C179.389 95.8 180.979 96.73 182.299 97.99L183.679 96.28C182.029 94.75 180.169 93.7 177.289 93.7C172.039 93.7 168.079 98.08 168.079 104.44V104.62C168.079 111.01 171.949 115.3 177.139 115.3ZM208.46 115.36L210.17 114.13L207.02 110.47C207.98 108.94 208.79 107.14 209.54 105.1L207.71 104.35C207.08 106.09 206.45 107.59 205.67 108.91L201.44 103.81C204.17 102.52 205.88 100.84 205.88 98.29V98.2C205.88 95.74 203.99 93.67 201.23 93.67C198.2 93.67 196.22 95.83 196.22 98.38V98.47C196.22 100.09 196.85 101.41 198.29 103.27C195.38 104.74 193.73 106.84 193.73 109.51V109.6C193.73 112.9 196.25 115.27 199.67 115.27C202.16 115.27 204.08 114.1 205.7 112.18L208.46 115.36ZM200.27 102.46C198.8 100.66 198.32 99.64 198.32 98.44V98.38C198.32 96.79 199.49 95.53 201.17 95.53C202.7 95.53 203.81 96.73 203.81 98.32V98.35C203.81 100.09 202.64 101.41 200.27 102.46ZM199.85 113.35C197.57 113.35 196.01 111.67 196.01 109.48V109.39C196.01 107.65 197.03 105.88 199.46 104.71L204.44 110.71C203.15 112.33 201.65 113.35 199.85 113.35ZM221.213 115H228.473C232.883 115 235.793 112.9 235.793 109.33V109.24C235.793 106.39 233.903 104.92 231.443 104.2C233.183 103.51 234.893 102.1 234.893 99.31V99.25C234.893 97.84 234.383 96.67 233.513 95.8C232.343 94.63 230.543 94 228.323 94H221.213V115ZM232.613 99.61C232.613 102.04 230.783 103.42 227.993 103.42H223.463V96.04H228.203C230.993 96.04 232.613 97.39 232.613 99.55V99.61ZM233.513 109.12V109.18C233.513 111.58 231.593 112.96 228.563 112.96H223.463V105.4H228.293C231.683 105.4 233.513 106.78 233.513 109.12ZM238.199 115H240.509L242.549 109.48H251.999L254.039 115H256.439L248.429 93.88H246.209L238.199 115ZM243.299 107.44L247.289 96.79L251.249 107.44H243.299ZM262.188 115H264.438V96.1H270.348V94H256.308V96.1H262.188V115ZM278.506 115H280.756V96.1H286.666V94H272.626V96.1H278.506V115ZM290.325 115H303.285V112.93H292.575V105.43H302.055V103.39H292.575V96.07H303.135V94H290.325V115ZM307.317 115H309.567V106.84H314.337L319.617 115H322.317L316.677 106.39C319.587 105.67 321.657 103.66 321.657 100.33V100.27C321.657 98.5 321.057 97 320.007 95.95C318.807 94.72 316.887 94 314.487 94H307.317V115ZM309.567 104.8V96.07H314.337C317.487 96.07 319.407 97.6 319.407 100.36V100.42C319.407 103.09 317.517 104.8 314.097 104.8H309.567ZM330.707 115H332.987V106.48L340.367 94H337.817L331.877 104.26L325.937 94H323.327L330.707 106.54V115ZM363.526 115H365.776V96.1H371.686V94H357.646V96.1H363.526V115ZM375.344 115H388.304V112.93H377.594V105.43H387.074V103.39H377.594V96.07H388.154V94H375.344V115ZM392.336 115H394.526V98.08L401.006 109.3H401.096L407.576 98.08V115H409.826V94H407.486L401.066 105.25L394.676 94H392.336V115ZM414.866 115H417.116V107.59H420.926C425.216 107.56 428.576 105.16 428.576 100.72V100.66C428.576 96.52 425.666 94 421.196 94H414.866V115ZM417.116 105.55V96.07H421.076C424.256 96.07 426.296 97.69 426.296 100.75V100.78C426.296 103.66 424.256 105.55 420.986 105.55H417.116Z'
          fill='white'
        />
        <Path d='M7 88H535' stroke='white' strokeWidth={2} />
      </Svg>
    </View>
  );
};

export default TopIndicator;
