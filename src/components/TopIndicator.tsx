import React, { useEffect } from 'react';
import { StyleProp, StyleSheet, View, ViewStyle } from 'react-native';
import {
  useSharedValue,
  withRepeat,
  withTiming,
} from 'react-native-reanimated';
import Svg, { Path } from 'react-native-svg';

import { FINAL_TOP_INDICATOR_HEIGHT } from '../utils/config';
import AnimatedIndicator from './AnimatedIndicator';

const styles = StyleSheet.create({
  container: {
    alignItems: 'center',
    backgroundColor: 'black',
  },
});

const transforms = [
  'matrix(1 0 0 -1 40 45.5)',
  'matrix(1 0 0 -1 160 45.5)',
  'matrix(1 0 0 -1 280 45.5)',
  'matrix(1 0 0 -1 402.5 45.5)',
  'matrix(1 0 0 -1 525 45.5)',
];

type TopIndicatorProps = {
  style?: StyleProp<ViewStyle>;
};

const TopIndicator = ({ style }: TopIndicatorProps): JSX.Element => {
  const progress = useSharedValue(0);
  useEffect(() => {
    progress.value = withRepeat(withTiming(1, { duration: 2000 }), -1, true);
  }, [progress]);

  return (
    <View style={[styles.container, style]}>
      <Svg
        width='60%'
        height={FINAL_TOP_INDICATOR_HEIGHT}
        viewBox='0 0 535 121'
        fill='none'>
        {transforms.map((transform, key) => (
          <AnimatedIndicator
            transform={transform}
            progress={progress}
            // eslint-disable-next-line react/no-array-index-key
            key={key}
          />
        ))}
        <Path
          d='M18.7783 121V102.06H11.7031V99.5254H28.7246V102.06H21.6201V121H18.7783ZM31.6543 121V99.5254H39.7549C41.1807 99.5254 42.2695 99.5938 43.0215 99.7305C44.0762 99.9062 44.96 100.243 45.6729 100.741C46.3857 101.229 46.957 101.918 47.3867 102.807C47.8262 103.695 48.0459 104.672 48.0459 105.736C48.0459 107.562 47.4648 109.11 46.3027 110.38C45.1406 111.64 43.041 112.27 40.0039 112.27H34.4961V121H31.6543ZM34.4961 109.735H40.0479C41.8838 109.735 43.1875 109.394 43.959 108.71C44.7305 108.026 45.1162 107.064 45.1162 105.824C45.1162 104.926 44.8867 104.159 44.4277 103.524C43.9785 102.88 43.3828 102.455 42.6406 102.25C42.1621 102.123 41.2783 102.06 39.9893 102.06H34.4961V109.735ZM65.7559 99.5254H68.5977V111.933C68.5977 114.091 68.3535 115.805 67.8652 117.074C67.377 118.344 66.4932 119.379 65.2139 120.18C63.9443 120.971 62.2744 121.366 60.2041 121.366C58.1924 121.366 56.5469 121.02 55.2676 120.326C53.9883 119.633 53.0752 118.632 52.5283 117.323C51.9814 116.005 51.708 114.208 51.708 111.933V99.5254H54.5498V111.918C54.5498 113.783 54.7207 115.16 55.0625 116.049C55.4141 116.928 56.0098 117.606 56.8496 118.085C57.6992 118.563 58.7344 118.803 59.9551 118.803C62.0449 118.803 63.5342 118.329 64.4229 117.382C65.3115 116.435 65.7559 114.613 65.7559 111.918V99.5254ZM130.824 114.101L133.505 113.866C133.632 114.94 133.925 115.824 134.384 116.518C134.853 117.201 135.575 117.758 136.552 118.188C137.528 118.607 138.627 118.817 139.848 118.817C140.932 118.817 141.889 118.656 142.719 118.334C143.549 118.012 144.164 117.572 144.564 117.016C144.975 116.449 145.18 115.834 145.18 115.17C145.18 114.496 144.984 113.91 144.594 113.412C144.203 112.904 143.559 112.479 142.66 112.138C142.084 111.913 140.81 111.566 138.837 111.098C136.864 110.619 135.482 110.17 134.691 109.75C133.666 109.213 132.899 108.549 132.392 107.758C131.894 106.957 131.645 106.063 131.645 105.077C131.645 103.993 131.952 102.982 132.567 102.045C133.183 101.098 134.081 100.38 135.263 99.8916C136.444 99.4033 137.758 99.1592 139.203 99.1592C140.795 99.1592 142.196 99.418 143.407 99.9355C144.628 100.443 145.565 101.195 146.22 102.191C146.874 103.188 147.226 104.315 147.274 105.575L144.55 105.78C144.403 104.423 143.905 103.397 143.056 102.704C142.216 102.011 140.971 101.664 139.32 101.664C137.602 101.664 136.347 101.981 135.556 102.616C134.774 103.241 134.384 103.998 134.384 104.887C134.384 105.658 134.662 106.293 135.219 106.791C135.766 107.289 137.191 107.802 139.496 108.329C141.811 108.847 143.397 109.301 144.257 109.691C145.507 110.268 146.43 111 147.025 111.889C147.621 112.768 147.919 113.783 147.919 114.936C147.919 116.078 147.592 117.157 146.938 118.173C146.283 119.179 145.341 119.965 144.11 120.531C142.89 121.088 141.513 121.366 139.979 121.366C138.036 121.366 136.405 121.083 135.087 120.517C133.778 119.95 132.748 119.101 131.996 117.968C131.254 116.825 130.863 115.536 130.824 114.101ZM149.442 121L157.689 99.5254H160.751L169.54 121H166.303L163.798 114.496H154.818L152.46 121H149.442ZM155.639 112.182H162.919L160.678 106.234C159.994 104.428 159.486 102.943 159.154 101.781C158.881 103.158 158.495 104.525 157.997 105.883L155.639 112.182ZM170.844 114.101L173.524 113.866C173.651 114.94 173.944 115.824 174.403 116.518C174.872 117.201 175.595 117.758 176.571 118.188C177.548 118.607 178.646 118.817 179.867 118.817C180.951 118.817 181.908 118.656 182.738 118.334C183.568 118.012 184.184 117.572 184.584 117.016C184.994 116.449 185.199 115.834 185.199 115.17C185.199 114.496 185.004 113.91 184.613 113.412C184.223 112.904 183.578 112.479 182.68 112.138C182.104 111.913 180.829 111.566 178.856 111.098C176.884 110.619 175.502 110.17 174.711 109.75C173.686 109.213 172.919 108.549 172.411 107.758C171.913 106.957 171.664 106.063 171.664 105.077C171.664 103.993 171.972 102.982 172.587 102.045C173.202 101.098 174.101 100.38 175.282 99.8916C176.464 99.4033 177.777 99.1592 179.223 99.1592C180.814 99.1592 182.216 99.418 183.427 99.9355C184.647 100.443 185.585 101.195 186.239 102.191C186.894 103.188 187.245 104.315 187.294 105.575L184.569 105.78C184.423 104.423 183.925 103.397 183.075 102.704C182.235 102.011 180.99 101.664 179.34 101.664C177.621 101.664 176.366 101.981 175.575 102.616C174.794 103.241 174.403 103.998 174.403 104.887C174.403 105.658 174.682 106.293 175.238 106.791C175.785 107.289 177.211 107.802 179.516 108.329C181.83 108.847 183.417 109.301 184.276 109.691C185.526 110.268 186.449 111 187.045 111.889C187.641 112.768 187.938 113.783 187.938 114.936C187.938 116.078 187.611 117.157 186.957 118.173C186.303 119.179 185.36 119.965 184.13 120.531C182.909 121.088 181.532 121.366 179.999 121.366C178.056 121.366 176.425 121.083 175.106 120.517C173.798 119.95 172.768 119.101 172.016 117.968C171.273 116.825 170.883 115.536 170.844 114.101ZM250.326 121V99.5254H265.854V102.06H253.168V108.637H265.048V111.156H253.168V118.466H266.352V121H250.326ZM285.6 113.471L288.441 114.188C287.846 116.522 286.771 118.305 285.219 119.535C283.676 120.756 281.786 121.366 279.55 121.366C277.235 121.366 275.351 120.897 273.896 119.96C272.45 119.013 271.347 117.646 270.585 115.858C269.833 114.071 269.457 112.152 269.457 110.102C269.457 107.865 269.882 105.917 270.731 104.257C271.591 102.587 272.807 101.322 274.379 100.463C275.961 99.5938 277.699 99.1592 279.594 99.1592C281.742 99.1592 283.549 99.7061 285.014 100.8C286.479 101.894 287.499 103.432 288.075 105.414L285.277 106.073C284.779 104.511 284.057 103.373 283.109 102.66C282.162 101.947 280.971 101.591 279.535 101.591C277.885 101.591 276.503 101.986 275.39 102.777C274.286 103.568 273.51 104.633 273.061 105.971C272.611 107.299 272.387 108.671 272.387 110.087C272.387 111.913 272.65 113.51 273.178 114.877C273.715 116.234 274.545 117.25 275.668 117.924C276.791 118.598 278.007 118.935 279.315 118.935C280.907 118.935 282.255 118.476 283.358 117.558C284.462 116.64 285.209 115.277 285.6 113.471ZM306.049 99.5254H308.891V111.933C308.891 114.091 308.646 115.805 308.158 117.074C307.67 118.344 306.786 119.379 305.507 120.18C304.237 120.971 302.567 121.366 300.497 121.366C298.485 121.366 296.84 121.02 295.561 120.326C294.281 119.633 293.368 118.632 292.821 117.323C292.274 116.005 292.001 114.208 292.001 111.933V99.5254H294.843V111.918C294.843 113.783 295.014 115.16 295.355 116.049C295.707 116.928 296.303 117.606 297.143 118.085C297.992 118.563 299.027 118.803 300.248 118.803C302.338 118.803 303.827 118.329 304.716 117.382C305.604 116.435 306.049 114.613 306.049 111.918V99.5254ZM371.967 121V99.5254H380.023C381.664 99.5254 382.978 99.7451 383.964 100.185C384.96 100.614 385.736 101.283 386.293 102.191C386.859 103.09 387.143 104.032 387.143 105.019C387.143 105.937 386.894 106.801 386.396 107.611C385.897 108.422 385.146 109.076 384.14 109.574C385.438 109.955 386.435 110.604 387.128 111.522C387.831 112.44 388.183 113.524 388.183 114.774C388.183 115.78 387.968 116.718 387.538 117.587C387.118 118.446 386.596 119.11 385.971 119.579C385.346 120.048 384.56 120.404 383.612 120.648C382.675 120.883 381.522 121 380.155 121H371.967ZM374.809 108.549H379.452C380.712 108.549 381.615 108.466 382.162 108.3C382.885 108.085 383.427 107.729 383.788 107.23C384.159 106.732 384.345 106.107 384.345 105.355C384.345 104.643 384.174 104.018 383.832 103.48C383.49 102.934 383.002 102.562 382.367 102.367C381.732 102.162 380.644 102.06 379.101 102.06H374.809V108.549ZM374.809 118.466H380.155C381.073 118.466 381.718 118.432 382.089 118.363C382.743 118.246 383.29 118.051 383.729 117.777C384.169 117.504 384.53 117.108 384.813 116.591C385.097 116.063 385.238 115.458 385.238 114.774C385.238 113.974 385.033 113.28 384.623 112.694C384.213 112.099 383.642 111.684 382.909 111.449C382.187 111.205 381.142 111.083 379.774 111.083H374.809V118.466ZM392.006 121V99.5254H396.283L401.366 114.73C401.835 116.146 402.177 117.206 402.392 117.909C402.636 117.128 403.017 115.98 403.534 114.467L408.676 99.5254H412.499V121H409.76V103.026L403.52 121H400.956L394.745 102.719V121H392.006ZM416.117 114.101L418.798 113.866C418.925 114.94 419.218 115.824 419.677 116.518C420.146 117.201 420.868 117.758 421.845 118.188C422.821 118.607 423.92 118.817 425.141 118.817C426.225 118.817 427.182 118.656 428.012 118.334C428.842 118.012 429.457 117.572 429.857 117.016C430.268 116.449 430.473 115.834 430.473 115.17C430.473 114.496 430.277 113.91 429.887 113.412C429.496 112.904 428.852 112.479 427.953 112.138C427.377 111.913 426.103 111.566 424.13 111.098C422.157 110.619 420.775 110.17 419.984 109.75C418.959 109.213 418.192 108.549 417.685 107.758C417.187 106.957 416.938 106.063 416.938 105.077C416.938 103.993 417.245 102.982 417.86 102.045C418.476 101.098 419.374 100.38 420.556 99.8916C421.737 99.4033 423.051 99.1592 424.496 99.1592C426.088 99.1592 427.489 99.418 428.7 99.9355C429.921 100.443 430.858 101.195 431.513 102.191C432.167 103.188 432.519 104.315 432.567 105.575L429.843 105.78C429.696 104.423 429.198 103.397 428.349 102.704C427.509 102.011 426.264 101.664 424.613 101.664C422.895 101.664 421.64 101.981 420.849 102.616C420.067 103.241 419.677 103.998 419.677 104.887C419.677 105.658 419.955 106.293 420.512 106.791C421.059 107.289 422.484 107.802 424.789 108.329C427.104 108.847 428.69 109.301 429.55 109.691C430.8 110.268 431.723 111 432.318 111.889C432.914 112.768 433.212 113.783 433.212 114.936C433.212 116.078 432.885 117.157 432.23 118.173C431.576 119.179 430.634 119.965 429.403 120.531C428.183 121.088 426.806 121.366 425.272 121.366C423.329 121.366 421.698 121.083 420.38 120.517C419.071 119.95 418.041 119.101 417.289 117.968C416.547 116.825 416.156 115.536 416.117 114.101ZM499.291 121L493.593 99.5254H496.508L499.774 113.603C500.126 115.077 500.429 116.542 500.683 117.997C501.229 115.702 501.552 114.379 501.649 114.027L505.736 99.5254H509.164L512.24 110.395C513.012 113.09 513.568 115.624 513.91 117.997C514.184 116.64 514.54 115.082 514.979 113.324L518.349 99.5254H521.205L515.316 121H512.577L508.051 104.638C507.67 103.271 507.445 102.431 507.377 102.118C507.152 103.104 506.942 103.944 506.747 104.638L502.191 121H499.291ZM523.959 121V99.5254H526.801V108.344H537.963V99.5254H540.805V121H537.963V110.878H526.801V121H523.959ZM545.434 121V99.5254H548.275V118.466H558.852V121H545.434Z'
          fill='white'
        />
        <Path d='M0 88H572' stroke='white' strokeWidth={2} />
      </Svg>
    </View>
  );
};

TopIndicator.defaultProps = {
  style: undefined,
};

export default TopIndicator;
